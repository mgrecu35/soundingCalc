! ###########################################################
!            Satellite Data Simulation Unit v2
!                   - refind_vir -
!
! This subroutines provides refractive indices of cloud/precip
! particles at visible and infrared wavelengths. 
! Two subroutines are included.
!  watrefind_vir: for water refractive index
!  icerefind_vir: for ice refractive index
! Data were extracted from AERDB stored in RSTAR6b.
!
!                                           H. M. (May, 2009)
!
 Subroutine watrefind_vir ( wl, crefd )
   Implicit NONE
!
! I/O parameters
!
! wl: wavelength in [micron]
! crefd: complex refractice index
!
   real(8), intent(in) :: wl
   complex(kind(0d0)), intent(out) :: crefd
!
! local variables
!
   real(8) :: ref_r,ref_i
   integer, parameter :: nw_ref = 201
   real(8), dimension(nw_ref), save :: wlref = (/ &
   2.000d-1,2.070d-1,2.143d-1,2.218d-1,2.296d-1,2.377d-1,2.461d-1,&
   2.547d-1,2.637d-1,2.729d-1,2.825d-1,2.924d-1,3.027d-1,3.134d-1,&
   3.244d-1,3.358d-1,3.476d-1,3.598d-1,3.724d-1,3.855d-1,3.991d-1,&
   4.131d-1,4.276d-1,4.426d-1,4.582d-1,4.743d-1,4.909d-1,5.082d-1,&
   5.261d-1,5.445d-1,5.637d-1,5.835d-1,6.040d-1,6.252d-1,6.472d-1,&
   6.699d-1,6.935d-1,7.178d-1,7.431d-1,7.692d-1,7.962d-1,8.242d-1,&
   8.532d-1,8.831d-1,9.142d-1,9.463d-1,9.796d-1,1.014d+0,1.050d+0,&
   1.087d+0,1.125d+0,1.164d+0,1.205d+0,1.247d+0,1.291d+0,1.337d+0,&
   1.384d+0,1.432d+0,1.483d+0,1.535d+0,1.589d+0,1.644d+0,1.702d+0,&
   1.762d+0,1.824d+0,1.888d+0,1.954d+0,2.023d+0,2.094d+0,2.168d+0,&
   2.244d+0,2.323d+0,2.405d+0,2.489d+0,2.576d+0,2.667d+0,2.761d+0,&
   2.858d+0,2.958d+0,3.062d+0,3.170d+0,3.281d+0,3.396d+0,3.516d+0,&
   3.639d+0,3.767d+0,3.900d+0,4.037d+0,4.179d+0,4.325d+0,4.477d+0,&
   4.635d+0,4.798d+0,4.966d+0,5.141d+0,5.321d+0,5.508d+0,5.702d+0,&
   5.902d+0,6.110d+0,6.325d+0,6.547d+0,6.777d+0,7.015d+0,7.262d+0,&
   7.517d+0,7.781d+0,8.054d+0,8.337d+0,8.630d+0,8.934d+0,9.248d+0,&
   9.573d+0,9.909d+0,1.026d+1,1.062d+1,1.099d+1,1.138d+1,1.178d+1,&
   1.219d+1,1.262d+1,1.306d+1,1.352d+1,1.400d+1,1.449d+1,1.500d+1,&
   1.552d+1,1.607d+1,1.664d+1,1.722d+1,1.783d+1,1.845d+1,1.910d+1,&
   1.977d+1,2.047d+1,2.119d+1,2.193d+1,2.270d+1,2.350d+1,2.432d+1,&
   2.518d+1,2.606d+1,2.698d+1,2.793d+1,2.891d+1,2.992d+1,3.098d+1,&
   3.206d+1,3.319d+1,3.436d+1,3.557d+1,3.682d+1,3.811d+1,3.945d+1,&
   4.083d+1,4.227d+1,4.376d+1,4.529d+1,4.688d+1,4.853d+1,5.024d+1,&
   5.200d+1,5.383d+1,5.572d+1,5.768d+1,5.971d+1,6.181d+1,6.398d+1,&
   6.623d+1,6.855d+1,7.096d+1,7.346d+1,7.604d+1,7.871d+1,8.148d+1,&
   8.434d+1,8.730d+1,9.037d+1,9.355d+1,9.683d+1,1.002d+2,1.038d+2,&
   1.074d+2,1.112d+2,1.151d+2,1.191d+2,1.233d+2,1.277d+2,1.321d+2,&
   1.368d+2,1.416d+2,1.466d+2,1.517d+2,1.570d+2,1.626d+2,1.683d+2,&
   1.742d+2,1.803d+2,1.867d+2,1.932d+2,2.000d+2 /)
!
   real(8), dimension(nw_ref), save :: refw_r = (/ &
      1.396d0,1.388d0,1.381d0,1.375d0,1.370d0,1.366d0,1.363d0,&
      1.360d0,1.357d0,1.355d0,1.352d0,1.350d0,1.349d0,1.347d0,&
      1.346d0,1.345d0,1.343d0,1.342d0,1.341d0,1.340d0,1.339d0,&
      1.338d0,1.338d0,1.337d0,1.337d0,1.336d0,1.335d0,1.335d0,&
      1.334d0,1.333d0,1.333d0,1.333d0,1.332d0,1.332d0,1.331d0,&
      1.331d0,1.331d0,1.330d0,1.330d0,1.330d0,1.329d0,1.329d0,&
      1.329d0,1.328d0,1.328d0,1.327d0,1.327d0,1.327d0,1.327d0,&
      1.326d0,1.325d0,1.325d0,1.324d0,1.323d0,1.323d0,1.322d0,&
      1.321d0,1.320d0,1.320d0,1.318d0,1.317d0,1.316d0,1.315d0,&
      1.313d0,1.311d0,1.310d0,1.308d0,1.305d0,1.302d0,1.298d0,&
      1.293d0,1.286d0,1.279d0,1.270d0,1.250d0,1.209d0,1.152d0,&
      1.154d0,1.307d0,1.437d0,1.483d0,1.457d0,1.421d0,1.397d0,&
      1.380d0,1.367d0,1.357d0,1.349d0,1.343d0,1.337d0,1.332d0,&
      1.330d0,1.330d0,1.326d0,1.320d0,1.311d0,1.297d0,1.277d0,&
      1.248d0,1.324d0,1.353d0,1.336d0,1.325d0,1.316d0,1.310d0,&
      1.303d0,1.297d0,1.290d0,1.283d0,1.274d0,1.264d0,1.253d0,&
      1.240d0,1.223d0,1.202d0,1.177d0,1.154d0,1.132d0,1.115d0,&
      1.113d0,1.128d0,1.150d0,1.178d0,1.210d0,1.240d0,1.270d0,&
      1.298d0,1.329d0,1.358d0,1.387d0,1.416d0,1.441d0,1.464d0,&
      1.479d0,1.482d0,1.489d0,1.499d0,1.508d0,1.516d0,1.524d0,&
      1.533d0,1.539d0,1.545d0,1.549d0,1.551d0,1.551d0,1.549d0,&
      1.546d0,1.540d0,1.534d0,1.529d0,1.525d0,1.522d0,1.519d0,&
      1.519d0,1.523d0,1.529d0,1.537d0,1.546d0,1.561d0,1.591d0,&
      1.617d0,1.638d0,1.658d0,1.678d0,1.700d0,1.725d0,1.752d0,&
      1.780d0,1.806d0,1.830d0,1.850d0,1.866d0,1.880d0,1.892d0,&
      1.903d0,1.914d0,1.925d0,1.938d0,1.950d0,1.958d0,1.960d0,&
      1.962d0,1.969d0,1.984d0,2.001d0,2.016d0,2.030d0,2.041d0,&
      2.051d0,2.058d0,2.065d0,2.071d0,2.077d0,2.084d0,2.092d0,&
      2.100d0,2.107d0,2.115d0,2.125d0,2.130d0 /)
!
   real(8), dimension(nw_ref), save :: refw_i = (/ &
   1.100d-7,8.430d-8,6.570d-8,5.290d-8,4.460d-8,3.930d-8,3.520d-8,&
   3.150d-8,2.780d-8,2.430d-8,2.090d-8,1.800d-8,1.540d-8,1.310d-8,&
   1.090d-8,8.810d-9,6.870d-9,5.170d-9,3.750d-9,2.630d-9,1.900d-9,&
   1.500d-9,1.260d-9,1.080d-9,9.740d-10,9.350d-10,9.540d-10,1.070d-9,&
   1.340d-9,1.790d-9,2.530d-9,5.330d-9,1.200d-8,1.390d-8,1.590d-8,&
   2.100d-8,2.840d-8,6.870d-8,1.440d-7,1.550d-7,1.240d-7,1.790d-7,&
   3.080d-7,4.100d-7,7.000d-7,2.630d-6,3.390d-6,2.650d-6,2.480d-6,&
   2.810d-6,3.780d-6,5.940d-6,1.070d-5,2.130d-5,4.300d-5,8.000d-5,&
   1.250d-4,1.520d-4,1.440d-4,1.180d-4,9.030d-5,7.130d-5,6.580d-5,&
   8.170d-5,1.560d-4,4.070d-4,9.030d-4,1.050d-3,6.050d-4,3.250d-4,&
   3.110d-4,5.340d-4,9.810d-4,1.410d-3,2.460d-3,9.260d-3,7.080d-2,&
   1.980d-1,2.960d-1,2.300d-1,1.160d-1,4.450d-2,1.990d-2,8.490d-3,&
   4.310d-3,3.380d-3,3.800d-3,4.950d-3,6.580d-3,8.850d-3,1.270d-2,&
   1.510d-2,1.500d-2,1.280d-2,1.060d-2,9.840d-3,1.170d-2,2.050d-2,&
   6.310d-2,1.220d-1,5.250d-2,3.730d-2,3.290d-2,3.200d-2,3.220d-2,&
   3.260d-2,3.340d-2,3.450d-2,3.580d-2,3.740d-2,3.940d-2,4.190d-2,&
   4.510d-2,4.930d-2,5.700d-2,7.200d-2,9.610d-2,1.300d-1,1.720d-1,&
   2.220d-1,2.720d-1,3.100d-1,3.440d-1,3.700d-1,3.880d-1,4.020d-1,&
   4.140d-1,4.230d-1,4.280d-1,4.290d-1,4.270d-1,4.220d-1,4.120d-1,&
   3.970d-1,3.860d-1,3.800d-1,3.740d-1,3.690d-1,3.640d-1,3.590d-1,&
   3.550d-1,3.500d-1,3.440d-1,3.380d-1,3.340d-1,3.280d-1,3.250d-1,&
   3.240d-1,3.260d-1,3.310d-1,3.400d-1,3.500d-1,3.620d-1,3.780d-1,&
   3.950d-1,4.130d-1,4.330d-1,4.530d-1,4.730d-1,4.950d-1,5.170d-1,&
   5.370d-1,5.540d-1,5.680d-1,5.790d-1,5.860d-1,5.890d-1,5.890d-1,&
   5.860d-1,5.800d-1,5.730d-1,5.650d-1,5.570d-1,5.500d-1,5.440d-1,&
   5.400d-1,5.380d-1,5.360d-1,5.340d-1,5.330d-1,5.320d-1,5.320d-1,&
   5.310d-1,5.310d-1,5.290d-1,5.270d-1,5.230d-1,5.170d-1,5.110d-1,&
   5.040d-1,4.990d-1,4.960d-1,4.950d-1,4.960d-1,4.960d-1,4.970d-1,&
   4.980d-1,4.990d-1,5.000d-1,5.020d-1,5.040d-1 /)
!
   crefd = 0.d0
   Call lintp8 ( nw_ref,wl,wlref,refw_r,ref_r )
   Call lintp8 ( nw_ref,wl,wlref,refw_i,ref_i )
   crefd = dcmplx ( ref_r,ref_i )
!
 End Subroutine watrefind_vir
!
 Subroutine icerefind_vir ( wl, crefd )
   Implicit NONE
!
! I/O parameters
!
! wl: wavelength in [micron]
! crefd: complex refractice index
!
   real(8), intent(in) :: wl
   complex(kind(0d0)), intent(out) :: crefd
!
! local variables
!
   real(8) :: ref_r,ref_i
   integer, parameter :: nw_ref = 201
   real(8), dimension(nw_ref) :: wlref = (/ &
   2.000d-1,2.070d-1,2.143d-1,2.218d-1,2.296d-1,2.377d-1,2.461d-1,&
   2.547d-1,2.637d-1,2.729d-1,2.825d-1,2.924d-1,3.027d-1,3.134d-1,&
   3.244d-1,3.358d-1,3.476d-1,3.598d-1,3.724d-1,3.855d-1,3.991d-1,&
   4.131d-1,4.276d-1,4.426d-1,4.582d-1,4.743d-1,4.909d-1,5.082d-1,&
   5.261d-1,5.445d-1,5.637d-1,5.835d-1,6.040d-1,6.252d-1,6.472d-1,&
   6.699d-1,6.935d-1,7.178d-1,7.431d-1,7.692d-1,7.962d-1,8.242d-1,&
   8.532d-1,8.831d-1,9.142d-1,9.463d-1,9.796d-1,1.014d+0,1.050d+0,&
   1.087d+0,1.125d+0,1.164d+0,1.205d+0,1.247d+0,1.291d+0,1.337d+0,&
   1.384d+0,1.432d+0,1.483d+0,1.535d+0,1.589d+0,1.644d+0,1.702d+0,&
   1.762d+0,1.824d+0,1.888d+0,1.954d+0,2.023d+0,2.094d+0,2.168d+0,&
   2.244d+0,2.323d+0,2.405d+0,2.489d+0,2.576d+0,2.667d+0,2.761d+0,&
   2.858d+0,2.958d+0,3.062d+0,3.170d+0,3.281d+0,3.396d+0,3.516d+0,&
   3.639d+0,3.767d+0,3.900d+0,4.037d+0,4.179d+0,4.325d+0,4.477d+0,&
   4.635d+0,4.798d+0,4.966d+0,5.141d+0,5.321d+0,5.508d+0,5.702d+0,&
   5.902d+0,6.110d+0,6.325d+0,6.547d+0,6.777d+0,7.015d+0,7.262d+0,&
   7.517d+0,7.781d+0,8.054d+0,8.337d+0,8.630d+0,8.934d+0,9.248d+0,&
   9.573d+0,9.909d+0,1.026d+1,1.062d+1,1.099d+1,1.138d+1,1.178d+1,&
   1.219d+1,1.262d+1,1.306d+1,1.352d+1,1.400d+1,1.449d+1,1.500d+1,&
   1.552d+1,1.607d+1,1.664d+1,1.722d+1,1.783d+1,1.845d+1,1.910d+1,&
   1.977d+1,2.047d+1,2.119d+1,2.193d+1,2.270d+1,2.350d+1,2.432d+1,&
   2.518d+1,2.606d+1,2.698d+1,2.793d+1,2.891d+1,2.992d+1,3.098d+1,&
   3.206d+1,3.319d+1,3.436d+1,3.557d+1,3.682d+1,3.811d+1,3.945d+1,&
   4.083d+1,4.227d+1,4.376d+1,4.529d+1,4.688d+1,4.853d+1,5.024d+1,&
   5.200d+1,5.383d+1,5.572d+1,5.768d+1,5.971d+1,6.181d+1,6.398d+1,&
   6.623d+1,6.855d+1,7.096d+1,7.346d+1,7.604d+1,7.871d+1,8.148d+1,&
   8.434d+1,8.730d+1,9.037d+1,9.355d+1,9.683d+1,1.002d+2,1.038d+2,&
   1.074d+2,1.112d+2,1.151d+2,1.191d+2,1.233d+2,1.277d+2,1.321d+2,&
   1.368d+2,1.416d+2,1.466d+2,1.517d+2,1.570d+2,1.626d+2,1.683d+2,&
   1.742d+2,1.803d+2,1.867d+2,1.932d+2,2.000d+2 /)
!
   real(8), dimension(nw_ref), save :: refi_r = (/ &
      1.393d0,1.384d0,1.375d0,1.368d0,1.362d0,1.357d0,1.353d0,&
      1.349d0,1.345d0,1.342d0,1.339d0,1.336d0,1.333d0,1.331d0,&
      1.329d0,1.327d0,1.325d0,1.324d0,1.322d0,1.321d0,1.319d0,&
      1.318d0,1.317d0,1.316d0,1.315d0,1.314d0,1.313d0,1.313d0,&
      1.312d0,1.311d0,1.310d0,1.310d0,1.309d0,1.309d0,1.308d0,&
      1.308d0,1.307d0,1.307d0,1.306d0,1.306d0,1.305d0,1.304d0,&
      1.304d0,1.303d0,1.303d0,1.302d0,1.302d0,1.301d0,1.301d0,&
      1.300d0,1.299d0,1.299d0,1.298d0,1.297d0,1.296d0,1.295d0,&
      1.294d0,1.293d0,1.292d0,1.291d0,1.290d0,1.288d0,1.286d0,&
      1.284d0,1.282d0,1.279d0,1.276d0,1.273d0,1.270d0,1.265d0,&
      1.258d0,1.250d0,1.241d0,1.228d0,1.209d0,1.178d0,1.122d0,&
      1.013d0, .999d0,1.233d0,1.628d0,1.590d0,1.507d0,1.449d0,&
      1.412d0,1.388d0,1.371d0,1.359d0,1.349d0,1.340d0,1.339d0,&
      1.348d0,1.340d0,1.331d0,1.321d0,1.311d0,1.300d0,1.290d0,&
      1.290d0,1.307d0,1.321d0,1.319d0,1.318d0,1.319d0,1.319d0,&
      1.316d0,1.316d0,1.312d0,1.299d0,1.286d0,1.274d0,1.261d0,&
      1.242d0,1.211d0,1.164d0,1.104d0,1.093d0,1.152d0,1.232d0,&
      1.321d0,1.409d0,1.482d0,1.534d0,1.569d0,1.582d0,1.572d0,&
      1.554d0,1.540d0,1.532d0,1.533d0,1.525d0,1.510d0,1.497d0,&
      1.501d0,1.497d0,1.483d0,1.467d0,1.450d0,1.434d0,1.419d0,&
      1.404d0,1.388d0,1.374d0,1.359d0,1.344d0,1.328d0,1.311d0,&
      1.291d0,1.267d0,1.239d0,1.218d0,1.204d0,1.197d0,1.199d0,&
      1.207d0,1.216d0,1.247d0,1.309d0,1.513d0,1.615d0,1.633d0,&
      1.677d0,1.731d0,1.776d0,1.668d0,1.589d0,1.636d0,1.710d0,&
      1.787d0,1.849d0,1.878d0,1.893d0,1.903d0,1.906d0,1.897d0,&
      1.879d0,1.865d0,1.855d0,1.846d0,1.839d0,1.832d0,1.827d0,&
      1.823d0,1.821d0,1.820d0,1.819d0,1.819d0,1.819d0,1.819d0,&
      1.819d0,1.820d0,1.821d0,1.823d0,1.826d0,1.828d0,1.830d0,&
      1.830d0,1.830d0,1.830d0,1.830d0,1.830d0 /)
!
   real(8), dimension(nw_ref), save :: refi_i = (/ &
   1.490d-8,1.370d-8,1.260d-8,1.160d-8,1.060d-8,9.760d-9,8.970d-9,&
   8.240d-9,7.570d-9,6.950d-9,6.390d-9,5.860d-9,5.380d-9,4.940d-9,&
   4.530d-9,4.160d-9,3.830d-9,3.530d-9,3.250d-9,2.980d-9,2.730d-9,&
   2.430d-9,2.110d-9,1.810d-9,1.520d-9,1.580d-9,1.790d-9,2.100d-9,&
   2.400d-9,3.060d-9,3.350d-9,4.340d-9,6.150d-9,9.540d-9,1.370d-8,&
   1.890d-8,2.560d-8,3.930d-8,5.180d-8,8.450d-8,1.290d-7,1.440d-7,&
   1.930d-7,3.560d-7,4.560d-7,5.760d-7,1.110d-6,2.120d-6,2.180d-6,&
   1.740d-6,1.900d-6,3.390d-6,7.630d-6,1.280d-5,1.320d-5,1.330d-5,&
   1.630d-5,1.220d-4,5.310d-4,5.350d-4,3.680d-4,2.540d-4,1.640d-4,&
   1.270d-4,8.870d-5,2.780d-4,1.200d-3,1.530d-3,9.600d-4,3.570d-4,&
   1.990d-4,4.350d-4,7.170d-4,9.140d-4,8.840d-4,2.990d-3,1.500d-2,&
   8.080d-2,3.280d-1,6.170d-1,3.900d-1,1.170d-1,4.010d-2,1.450d-2,&
   7.720d-3,6.660d-3,7.790d-3,1.020d-2,1.270d-2,1.850d-2,2.790d-2,&
   2.290d-2,1.470d-2,1.220d-2,1.290d-2,1.510d-2,2.170d-2,3.400d-2,&
   5.930d-2,6.980d-2,6.280d-2,5.540d-2,5.800d-2,5.530d-2,5.380d-2,&
   5.200d-2,5.070d-2,4.330d-2,3.650d-2,3.970d-2,4.200d-2,4.490d-2,&
   4.610d-2,4.840d-2,6.990d-2,1.300d-1,2.380d-1,3.420d-1,3.970d-1,&
   4.220d-1,4.170d-1,3.820d-1,3.340d-1,2.820d-1,2.220d-1,1.740d-1,&
   1.460d-1,1.290d-1,1.210d-1,1.080d-1,8.820d-2,7.420d-2,7.550d-2,&
   7.240d-2,5.350d-2,3.890d-2,3.080d-2,2.730d-2,2.720d-2,2.830d-2,&
   3.060d-2,3.430d-2,4.000d-2,4.740d-2,5.600d-2,6.530d-2,7.530d-2,&
   8.680d-2,1.030d-1,1.310d-1,1.730d-1,2.160d-1,2.680d-1,3.220d-1,&
   3.790d-1,4.340d-1,5.240d-1,6.320d-1,7.120d-1,5.690d-1,5.440d-1,&
   5.190d-1,4.520d-1,3.950d-1,3.130d-1,3.990d-1,5.190d-1,5.000d-1,&
   4.860d-1,4.320d-1,3.800d-1,3.360d-1,2.980d-1,2.550d-1,2.160d-1,&
   1.880d-1,1.750d-1,1.640d-1,1.540d-1,1.450d-1,1.390d-1,1.340d-1,&
   1.300d-1,1.270d-1,1.240d-1,1.210d-1,1.170d-1,1.140d-1,1.100d-1,&
   1.060d-1,1.020d-1,9.860d-2,9.510d-2,9.140d-2,8.710d-2,8.300d-2,&
   8.300d-2,8.300d-2,8.300d-2,8.300d-2,8.300d-2 /)
!
   crefd = 0.d0
   Call lintp8 ( nw_ref,wl,wlref,refi_r,ref_r )
   Call lintp8 ( nw_ref,wl,wlref,refi_i,ref_i )
   crefd = dcmplx ( ref_r,ref_i )
!
 End Subroutine icerefind_vir
